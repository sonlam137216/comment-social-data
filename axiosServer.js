const express = require('express');
const cors = require('cors');
const request = require('request');
const cheerio = require('cheerio');
const rp = require('request-promise');
const axios = require('axios');
const Excel = require('exceljs');
const path = require('path');

require('dotenv').config();

const workbook = new Excel.Workbook();
const worksheet = workbook.addWorksheet('data');

const dataColumns = [{ key: 'content', header: 'Content' }];

worksheet.columns = dataColumns;

const app = express();

app.use(express.json());

function sleep(ms) {
  return new Promise((resolve) => setTimeout(resolve, ms));
}

const itemInfo = [
  {
    itemId: '3015403040',
    limit: 50,
    offset: 0,
    shopId: '40342563',
    type: 0,
  },
  {
    itemId: '3015403040',
    limit: 50,
    offset: 0,
    shopId: '40342563',
    type: 1,
  },
  {
    itemId: '3015403040',
    limit: 50,
    offset: 0,
    shopId: '40342563',
    type: 2,
  },
  {
    itemId: '3015403040',
    limit: 50,
    offset: 0,
    shopId: '40342563',
    type: 3,
  },
  {
    itemId: '3015403040',
    limit: 50,
    offset: 0,
    shopId: '40342563',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 0,
    shopId: '448978223',
    type: 1,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 1,
    shopId: '448978223',
    type: 1,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 0,
    shopId: '448978223',
    type: 2,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 2,
    shopId: '448978223',
    type: 2,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 0,
    shopId: '448978223',
    type: 3,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 1,
    shopId: '448978223',
    type: 3,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 2,
    shopId: '448978223',
    type: 3,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 3,
    shopId: '448978223',
    type: 3,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 4,
    shopId: '448978223',
    type: 3,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 0,
    shopId: '448978223',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 1,
    shopId: '448978223',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 2,
    shopId: '448978223',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 3,
    shopId: '448978223',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 4,
    shopId: '448978223',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 5,
    shopId: '448978223',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 6,
    shopId: '448978223',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 7,
    shopId: '448978223',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 8,
    shopId: '448978223',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 9,
    shopId: '448978223',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 10,
    shopId: '448978223',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 11,
    shopId: '448978223',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 12,
    shopId: '448978223',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 13,
    shopId: '448978223',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 14,
    shopId: '448978223',
    type: 4,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 0,
    shopId: '448978223',
    type: 5,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 1,
    shopId: '448978223',
    type: 5,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 2,
    shopId: '448978223',
    type: 5,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 3,
    shopId: '448978223',
    type: 5,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 4,
    shopId: '448978223',
    type: 5,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 5,
    shopId: '448978223',
    type: 5,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 6,
    shopId: '448978223',
    type: 5,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 7,
    shopId: '448978223',
    type: 5,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 8,
    shopId: '448978223',
    type: 5,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 9,
    shopId: '448978223',
    type: 5,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 10,
    shopId: '448978223',
    type: 5,
  },
  {
    itemId: '11289182012',
    limit: 50,
    offset: 11,
    shopId: '448978223',
    type: 5,
  },
  {
    itemId: '18655290526',
    limit: 50,
    offset: 0,
    shopId: '180633733',
    type: 4,
  },
  {
    itemId: '18655290526',
    limit: 50,
    offset: 0,
    shopId: '180633733',
    type: 1,
  },
  {
    itemId: '18655290526',
    limit: 50,
    offset: 0,
    shopId: '180633733',
    type: 2,
  },
  {
    itemId: '18655290526',
    limit: 50,
    offset: 0,
    shopId: '180633733',
    type: 3,
  },
  {
    itemId: '18655290526',
    limit: 50,
    offset: 0,
    shopId: '180633733',
    type: 5,
  },
  {
    itemId: '7562984248',
    limit: 50,
    offset: 0,
    shopId: '233545991',
    type: 5,
  },
  {
    itemId: '7562984248',
    limit: 50,
    offset: 1,
    shopId: '233545991',
    type: 5,
  },
  {
    itemId: '7562984248',
    limit: 50,
    offset: 2,
    shopId: '233545991',
    type: 5,
  },
  {
    itemId: '7562984248',
    limit: 50,
    offset: 3,
    shopId: '233545991',
    type: 5,
  },
  {
    itemId: '7562984248',
    limit: 50,
    offset: 0,
    shopId: '233545991',
    type: 1,
  },
  {
    itemId: '7562984248',
    limit: 50,
    offset: 0,
    shopId: '233545991',
    type: 2,
  },
  {
    itemId: '7562984248',
    limit: 50,
    offset: 0,
    shopId: '233545991',
    type: 3,
  },
  {
    itemId: '7562984248',
    limit: 50,
    offset: 1,
    shopId: '233545991',
    type: 3,
  },
  {
    itemId: '7562984248',
    limit: 50,
    offset: 0,
    shopId: '233545991',
    type: 4,
  },
  {
    itemId: '7562984248',
    limit: 50,
    offset: 1,
    shopId: '233545991',
    type: 4,
  },
  {
    itemId: '7562984248',
    limit: 50,
    offset: 2,
    shopId: '233545991',
    type: 4,
  },
  {
    itemId: '7562984248',
    limit: 50,
    offset: 3,
    shopId: '233545991',
    type: 4,
  },
  {
    itemId: '7562984248',
    limit: 50,
    offset: 4,
    shopId: '233545991',
    type: 4,
  },
  {
    itemId: '7562984248',
    limit: 50,
    offset: 5,
    shopId: '233545991',
    type: 4,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 0,
    shopId: '82053562',
    type: 1,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 0,
    shopId: '82053562',
    type: 2,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 0,
    shopId: '82053562',
    type: 3,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 1,
    shopId: '82053562',
    type: 3,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 0,
    shopId: '82053562',
    type: 4,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 1,
    shopId: '82053562',
    type: 4,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 2,
    shopId: '82053562',
    type: 4,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 3,
    shopId: '82053562',
    type: 4,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 4,
    shopId: '82053562',
    type: 4,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 5,
    shopId: '82053562',
    type: 4,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 0,
    shopId: '82053562',
    type: 5,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 1,
    shopId: '82053562',
    type: 5,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 2,
    shopId: '82053562',
    type: 5,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 3,
    shopId: '82053562',
    type: 5,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 4,
    shopId: '82053562',
    type: 5,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 5,
    shopId: '82053562',
    type: 5,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 6,
    shopId: '82053562',
    type: 5,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 7,
    shopId: '82053562',
    type: 5,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 8,
    shopId: '82053562',
    type: 5,
  },
  {
    itemId: '21602882231',
    limit: 50,
    offset: 9,
    shopId: '82053562',
    type: 5,
  },
  {
    itemId: '10923992091',
    limit: 50,
    offset: 0,
    shopId: '407641325',
    type: 1,
  },
  {
    itemId: '10923992091',
    limit: 50,
    offset: 0,
    shopId: '407641325',
    type: 2,
  },
  {
    itemId: '10923992091',
    limit: 50,
    offset: 0,
    shopId: '407641325',
    type: 3,
  },
  {
    itemId: '10923992091',
    limit: 50,
    offset: 0,
    shopId: '407641325',
    type: 4,
  },
  {
    itemId: '10923992091',
    limit: 50,
    offset: 1,
    shopId: '407641325',
    type: 4,
  },
  {
    itemId: '10923992091',
    limit: 50,
    offset: 0,
    shopId: '407641325',
    type: 5,
  },
  {
    itemId: '10923992091',
    limit: 50,
    offset: 1,
    shopId: '407641325',
    type: 5,
  },
  {
    itemId: '10923992091',
    limit: 50,
    offset: 2,
    shopId: '407641325',
    type: 5,
  },
  {
    itemId: '10923992091',
    limit: 50,
    offset: 3,
    shopId: '407641325',
    type: 5,
  },
  {
    itemId: '10923992091',
    limit: 50,
    offset: 4,
    shopId: '407641325',
    type: 5,
  },
  {
    itemId: '10923992091',
    limit: 50,
    offset: 5,
    shopId: '407641325',
    type: 5,
  },
  {
    itemId: '10923992091',
    limit: 50,
    offset: 6,
    shopId: '407641325',
    type: 5,
  },
  {
    itemId: '10923992091',
    limit: 50,
    offset: 7,
    shopId: '407641325',
    type: 5,
  },
  {
    itemId: '10923992091',
    limit: 50,
    offset: 8,
    shopId: '407641325',
    type: 5,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 0,
    shopId: '687023655',
    type: 1,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 0,
    shopId: '687023655',
    type: 2,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 0,
    shopId: '687023655',
    type: 3,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 1,
    shopId: '687023655',
    type: 3,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 0,
    shopId: '687023655',
    type: 4,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 1,
    shopId: '687023655',
    type: 4,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 2,
    shopId: '687023655',
    type: 4,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 3,
    shopId: '687023655',
    type: 4,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 4,
    shopId: '687023655',
    type: 4,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 5,
    shopId: '687023655',
    type: 4,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 0,
    shopId: '687023655',
    type: 5,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 1,
    shopId: '687023655',
    type: 5,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 2,
    shopId: '687023655',
    type: 5,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 3,
    shopId: '687023655',
    type: 5,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 4,
    shopId: '687023655',
    type: 5,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 5,
    shopId: '687023655',
    type: 5,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 6,
    shopId: '687023655',
    type: 5,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 7,
    shopId: '687023655',
    type: 5,
  },
  {
    itemId: '18762867993',
    limit: 50,
    offset: 7,
    shopId: '687023655',
    type: 5,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 0,
    shopId: '125254308',
    type: 1,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 0,
    shopId: '125254308',
    type: 2,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 0,
    shopId: '125254308',
    type: 3,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 1,
    shopId: '125254308',
    type: 3,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 0,
    shopId: '125254308',
    type: 4,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 1,
    shopId: '125254308',
    type: 4,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 2,
    shopId: '125254308',
    type: 4,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 0,
    shopId: '125254308',
    type: 5,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 1,
    shopId: '125254308',
    type: 5,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 2,
    shopId: '125254308',
    type: 5,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 3,
    shopId: '125254308',
    type: 5,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 4,
    shopId: '125254308',
    type: 5,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 5,
    shopId: '125254308',
    type: 5,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 6,
    shopId: '125254308',
    type: 5,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 7,
    shopId: '125254308',
    type: 5,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 8,
    shopId: '125254308',
    type: 5,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 9,
    shopId: '125254308',
    type: 5,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 10,
    shopId: '125254308',
    type: 5,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 11,
    shopId: '125254308',
    type: 5,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 12,
    shopId: '125254308',
    type: 5,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 13,
    shopId: '125254308',
    type: 5,
  },
  {
    itemId: '5046043606',
    limit: 50,
    offset: 14,
    shopId: '125254308',
    type: 5,
  },
];

const items = [
  {
    itemId: '13190051003',
    limit: 20,
    offset: 0,
    shopId: '753272949',
    type: 1,
  },
  {
    itemId: '13190051003',
    limit: 20,
    offset: 0,
    shopId: '753272949',
    type: 2,
  },
  {
    itemId: '13190051003',
    limit: 20,
    offset: 0,
    shopId: '753272949',
    type: 3,
  },
  {
    itemId: '13190051003',
    limit: 20,
    offset: 0,
    shopId: '753272949',
    type: 4,
  },
  {
    itemId: '13190051003',
    limit: 20,
    offset: 0,
    shopId: '753272949',
    type: 5,
  },
  {
    itemId: '10818787267',
    limit: 20,
    offset: 0,
    shopId: '30142553',
    type: 1,
  },
  {
    itemId: '10818787267',
    limit: 20,
    offset: 0,
    shopId: '30142553',
    type: 2,
  },
  {
    itemId: '10818787267',
    limit: 20,
    offset: 0,
    shopId: '30142553',
    type: 3,
  },
  {
    itemId: '10818787267',
    limit: 20,
    offset: 0,
    shopId: '30142553',
    type: 4,
  },
  {
    itemId: '10818787267',
    limit: 20,
    offset: 0,
    shopId: '30142553',
    type: 5,
  },

  {
    itemId: '5634470072',
    limit: 20,
    offset: 0,
    shopId: '149210564',
    type: 1,
  },
  {
    itemId: '5634470072',
    limit: 20,
    offset: 0,
    shopId: '149210564',
    type: 2,
  },
  {
    itemId: '5634470072',
    limit: 20,
    offset: 0,
    shopId: '149210564',
    type: 3,
  },
  {
    itemId: '5634470072',
    limit: 20,
    offset: 0,
    shopId: '149210564',
    type: 4,
  },
  {
    itemId: '5634470072',
    limit: 20,
    offset: 0,
    shopId: '149210564',
    type: 5,
  },

  {
    itemId: '3087492918',
    limit: 20,
    offset: 0,
    shopId: '241418324',
    type: 1,
  },
  {
    itemId: '3087492918',
    limit: 20,
    offset: 0,
    shopId: '241418324',
    type: 2,
  },
  {
    itemId: '3087492918',
    limit: 20,
    offset: 0,
    shopId: '241418324',
    type: 3,
  },
  {
    itemId: '3087492918',
    limit: 20,
    offset: 0,
    shopId: '241418324',
    type: 4,
  },
  {
    itemId: '3087492918',
    limit: 20,
    offset: 0,
    shopId: '241418324',
    type: 5,
  },

  {
    itemId: '21975940952',
    limit: 20,
    offset: 0,
    shopId: '496009545',
    type: 1,
  },
  {
    itemId: '21975940952',
    limit: 20,
    offset: 0,
    shopId: '496009545',
    type: 2,
  },
  {
    itemId: '21975940952',
    limit: 20,
    offset: 0,
    shopId: '496009545',
    type: 3,
  },
  {
    itemId: '21975940952',
    limit: 20,
    offset: 0,
    shopId: '496009545',
    type: 4,
  },
  {
    itemId: '21975940952',
    limit: 20,
    offset: 0,
    shopId: '496009545',
    type: 5,
  },

  {
    itemId: '23233480059',
    limit: 20,
    offset: 0,
    shopId: '496009545',
    type: 1,
  },
  {
    itemId: '23233480059',
    limit: 20,
    offset: 0,
    shopId: '496009545',
    type: 2,
  },
  {
    itemId: '23233480059',
    limit: 20,
    offset: 0,
    shopId: '496009545',
    type: 3,
  },
  {
    itemId: '23233480059',
    limit: 20,
    offset: 0,
    shopId: '496009545',
    type: 4,
  },
  {
    itemId: '23233480059',
    limit: 20,
    offset: 0,
    shopId: '496009545',
    type: 5,
  },

  {
    itemId: '3554096264',
    limit: 20,
    offset: 0,
    shopId: '257372007',
    type: 1,
  },
  {
    itemId: '3554096264',
    limit: 20,
    offset: 0,
    shopId: '257372007',
    type: 2,
  },
  {
    itemId: '3554096264',
    limit: 20,
    offset: 0,
    shopId: '257372007',
    type: 3,
  },
  {
    itemId: '3554096264',
    limit: 20,
    offset: 0,
    shopId: '257372007',
    type: 4,
  },
  {
    itemId: '3554096264',
    limit: 20,
    offset: 0,
    shopId: '257372007',
    type: 5,
  },

  {
    itemId: '16193943186',
    limit: 20,
    offset: 0,
    shopId: '496009545',
    type: 1,
  },
  {
    itemId: '16193943186',
    limit: 20,
    offset: 0,
    shopId: '496009545',
    type: 2,
  },
  {
    itemId: '16193943186',
    limit: 20,
    offset: 0,
    shopId: '496009545',
    type: 3,
  },
  {
    itemId: '16193943186',
    limit: 20,
    offset: 0,
    shopId: '496009545',
    type: 4,
  },
  {
    itemId: '16193943186',
    limit: 20,
    offset: 0,
    shopId: '496009545',
    type: 5,
  },

  {
    itemId: '4917527297',
    limit: 20,
    offset: 0,
    shopId: '146822363',
    type: 1,
  },
  {
    itemId: '4917527297',
    limit: 20,
    offset: 0,
    shopId: '146822363',
    type: 2,
  },
  {
    itemId: '4917527297',
    limit: 20,
    offset: 0,
    shopId: '146822363',
    type: 3,
  },
  {
    itemId: '4917527297',
    limit: 20,
    offset: 0,
    shopId: '146822363',
    type: 4,
  },
  {
    itemId: '4917527297',
    limit: 20,
    offset: 0,
    shopId: '146822363',
    type: 5,
  },

  {
    itemId: '2724098256',
    limit: 20,
    offset: 0,
    shopId: '17121110',
    type: 1,
  },
  {
    itemId: '2724098256',
    limit: 20,
    offset: 0,
    shopId: '17121110',
    type: 2,
  },
  {
    itemId: '2724098256',
    limit: 20,
    offset: 0,
    shopId: '17121110',
    type: 3,
  },
  {
    itemId: '2724098256',
    limit: 20,
    offset: 0,
    shopId: '17121110',
    type: 4,
  },
  {
    itemId: '2724098256',
    limit: 20,
    offset: 0,
    shopId: '17121110',
    type: 5,
  },

  {
    itemId: '15418183989',
    limit: 20,
    offset: 0,
    shopId: '276111985',
    type: 1,
  },
  {
    itemId: '15418183989',
    limit: 20,
    offset: 0,
    shopId: '276111985',
    type: 2,
  },
  {
    itemId: '15418183989',
    limit: 20,
    offset: 0,
    shopId: '276111985',
    type: 3,
  },
  {
    itemId: '15418183989',
    limit: 20,
    offset: 0,
    shopId: '276111985',
    type: 4,
  },
  {
    itemId: '15418183989',
    limit: 20,
    offset: 0,
    shopId: '276111985',
    type: 5,
  },
];

const item1 = [
  {
    itemId: '13194411257',
    limit: 20,
    offset: 0,
    shopId: '45402331',
    type: 1,
  },
  {
    itemId: '13194411257',
    limit: 20,
    offset: 0,
    shopId: '45402331',
    type: 2,
  },
  {
    itemId: '13194411257',
    limit: 20,
    offset: 0,
    shopId: '45402331',
    type: 3,
  },
  {
    itemId: '13194411257',
    limit: 20,
    offset: 0,
    shopId: '45402331',
    type: 4,
  },
  {
    itemId: '13194411257',
    limit: 20,
    offset: 0,
    shopId: '45402331',
    type: 5,
  },

  {
    itemId: '13482385000',
    limit: 30,
    offset: 0,
    shopId: '37101020',
    type: 1,
  },
  {
    itemId: '13482385000',
    limit: 30,
    offset: 0,
    shopId: '37101020',
    type: 2,
  },
  {
    itemId: '13482385000',
    limit: 30,
    offset: 0,
    shopId: '37101020',
    type: 3,
  },
  {
    itemId: '13482385000',
    limit: 30,
    offset: 0,
    shopId: '37101020',
    type: 4,
  },
  {
    itemId: '13482385000',
    limit: 30,
    offset: 0,
    shopId: '37101020',
    type: 5,
  },

  {
    itemId: '6956646139',
    limit: 30,
    offset: 0,
    shopId: '318031417',
    type: 1,
  },
  {
    itemId: '6956646139',
    limit: 30,
    offset: 0,
    shopId: '318031417',
    type: 2,
  },
  {
    itemId: '6956646139',
    limit: 30,
    offset: 0,
    shopId: '318031417',
    type: 3,
  },
  {
    itemId: '6956646139',
    limit: 30,
    offset: 0,
    shopId: '318031417',
    type: 4,
  },
  {
    itemId: '6956646139',
    limit: 30,
    offset: 0,
    shopId: '318031417',
    type: 5,
  },

  {
    itemId: '16314142099',
    limit: 30,
    offset: 0,
    shopId: '408231808',
    type: 1,
  },
  {
    itemId: '16314142099',
    limit: 30,
    offset: 0,
    shopId: '408231808',
    type: 2,
  },
  {
    itemId: '16314142099',
    limit: 30,
    offset: 0,
    shopId: '408231808',
    type: 3,
  },
  {
    itemId: '16314142099',
    limit: 30,
    offset: 0,
    shopId: '408231808',
    type: 4,
  },
  {
    itemId: '16314142099',
    limit: 30,
    offset: 0,
    shopId: '408231808',
    type: 5,
  },

  {
    itemId: '9139324990',
    limit: 30,
    offset: 0,
    shopId: '119800669',
    type: 1,
  },
  {
    itemId: '9139324990',
    limit: 30,
    offset: 0,
    shopId: '119800669',
    type: 2,
  },
  {
    itemId: '9139324990',
    limit: 30,
    offset: 0,
    shopId: '119800669',
    type: 3,
  },
  {
    itemId: '9139324990',
    limit: 30,
    offset: 0,
    shopId: '119800669',
    type: 4,
  },
  {
    itemId: '9139324990',
    limit: 30,
    offset: 0,
    shopId: '119800669',
    type: 5,
  },

  {
    itemId: '10294892177',
    limit: 30,
    offset: 0,
    shopId: '276574891',
    type: 1,
  },
  {
    itemId: '10294892177',
    limit: 30,
    offset: 0,
    shopId: '276574891',
    type: 2,
  },
  {
    itemId: '10294892177',
    limit: 30,
    offset: 0,
    shopId: '276574891',
    type: 3,
  },
  {
    itemId: '10294892177',
    limit: 30,
    offset: 0,
    shopId: '276574891',
    type: 4,
  },
  {
    itemId: '10294892177',
    limit: 30,
    offset: 0,
    shopId: '276574891',
    type: 5,
  },

  {
    itemId: '19413956707',
    limit: 30,
    offset: 0,
    shopId: '18837284',
    type: 1,
  },
  {
    itemId: '19413956707',
    limit: 30,
    offset: 0,
    shopId: '18837284',
    type: 2,
  },
  {
    itemId: '19413956707',
    limit: 30,
    offset: 0,
    shopId: '18837284',
    type: 3,
  },
  {
    itemId: '19413956707',
    limit: 30,
    offset: 0,
    shopId: '18837284',
    type: 4,
  },
  {
    itemId: '19413956707',
    limit: 30,
    offset: 0,
    shopId: '18837284',
    type: 5,
  },

  {
    itemId: '19308664153',
    limit: 30,
    offset: 0,
    shopId: '102763167',
    type: 1,
  },
  {
    itemId: '19308664153',
    limit: 30,
    offset: 0,
    shopId: '102763167',
    type: 2,
  },
  {
    itemId: '19308664153',
    limit: 30,
    offset: 0,
    shopId: '102763167',
    type: 3,
  },
  {
    itemId: '19308664153',
    limit: 30,
    offset: 0,
    shopId: '102763167',
    type: 4,
  },
  {
    itemId: '19308664153',
    limit: 30,
    offset: 0,
    shopId: '102763167',
    type: 5,
  },

  {
    itemId: '19413729687',
    limit: 30,
    offset: 0,
    shopId: '420779328',
    type: 1,
  },
  {
    itemId: '19413729687',
    limit: 30,
    offset: 0,
    shopId: '420779328',
    type: 2,
  },
  {
    itemId: '19413729687',
    limit: 30,
    offset: 0,
    shopId: '420779328',
    type: 3,
  },
  {
    itemId: '19413729687',
    limit: 30,
    offset: 0,
    shopId: '420779328',
    type: 4,
  },
  {
    itemId: '19413729687',
    limit: 30,
    offset: 0,
    shopId: '420779328',
    type: 5,
  },
];

const item2 = [
  {
    itemId: '22032533539',
    limit: 30,
    offset: 0,
    shopId: '853183768',
    type: 1,
  },
  {
    itemId: '22032533539',
    limit: 30,
    offset: 0,
    shopId: '853183768',
    type: 2,
  },
  {
    itemId: '22032533539',
    limit: 30,
    offset: 0,
    shopId: '853183768',
    type: 3,
  },
  {
    itemId: '22032533539',
    limit: 30,
    offset: 0,
    shopId: '853183768',
    type: 4,
  },
  {
    itemId: '22032533539',
    limit: 30,
    offset: 0,
    shopId: '853183768',
    type: 5,
  },

  {
    itemId: '2837799678',
    limit: 30,
    offset: 0,
    shopId: '43488350',
    type: 1,
  },
  {
    itemId: '2837799678',
    limit: 30,
    offset: 0,
    shopId: '43488350',
    type: 2,
  },
  {
    itemId: '2837799678',
    limit: 30,
    offset: 0,
    shopId: '43488350',
    type: 3,
  },
  {
    itemId: '2837799678',
    limit: 30,
    offset: 0,
    shopId: '43488350',
    type: 4,
  },
  {
    itemId: '2837799678',
    limit: 30,
    offset: 0,
    shopId: '43488350',
    type: 5,
  },

  {
    itemId: '16245946194',
    limit: 30,
    offset: 0,
    shopId: '460971368',
    type: 1,
  },
  {
    itemId: '16245946194',
    limit: 30,
    offset: 0,
    shopId: '460971368',
    type: 2,
  },
  {
    itemId: '16245946194',
    limit: 30,
    offset: 0,
    shopId: '460971368',
    type: 3,
  },
  {
    itemId: '16245946194',
    limit: 30,
    offset: 0,
    shopId: '460971368',
    type: 4,
  },
  {
    itemId: '16245946194',
    limit: 30,
    offset: 0,
    shopId: '460971368',
    type: 5,
  },

  {
    itemId: '18924061086',
    limit: 30,
    offset: 0,
    shopId: '345244231',
    type: 1,
  },
  {
    itemId: '18924061086',
    limit: 30,
    offset: 0,
    shopId: '345244231',
    type: 2,
  },
  {
    itemId: '18924061086',
    limit: 30,
    offset: 0,
    shopId: '345244231',
    type: 3,
  },
  {
    itemId: '18924061086',
    limit: 30,
    offset: 0,
    shopId: '345244231',
    type: 4,
  },
  {
    itemId: '18924061086',
    limit: 30,
    offset: 0,
    shopId: '345244231',
    type: 5,
  },

  {
    itemId: '3953691501',
    limit: 30,
    offset: 0,
    shopId: '61805616',
    type: 1,
  },
  {
    itemId: '3953691501',
    limit: 30,
    offset: 0,
    shopId: '61805616',
    type: 2,
  },
  {
    itemId: '3953691501',
    limit: 30,
    offset: 0,
    shopId: '61805616',
    type: 3,
  },
  {
    itemId: '3953691501',
    limit: 30,
    offset: 0,
    shopId: '61805616',
    type: 4,
  },
  {
    itemId: '3953691501',
    limit: 30,
    offset: 0,
    shopId: '61805616',
    type: 5,
  },

  {
    itemId: '8929441063',
    limit: 30,
    offset: 0,
    shopId: '201774917',
    type: 1,
  },
  {
    itemId: '8929441063',
    limit: 30,
    offset: 0,
    shopId: '201774917',
    type: 2,
  },
  {
    itemId: '8929441063',
    limit: 30,
    offset: 0,
    shopId: '201774917',
    type: 3,
  },
  {
    itemId: '8929441063',
    limit: 30,
    offset: 0,
    shopId: '201774917',
    type: 4,
  },
  {
    itemId: '8929441063',
    limit: 30,
    offset: 0,
    shopId: '201774917',
    type: 5,
  },
];

const formatComment = (comment) => {
  return comment.replace(/\s+/g, ' ').trim();
};

const crawlData = async () => {
  const ratings = [];

  await Promise.all(
    item2.map(async (item, index) => {
      const url = `
    https://shopee.vn/api/v2/item/get_ratings?exclude_filter=0&filter=0&filter_size=0&flag=1&fold_filter=0&itemid=${item.itemId}&limit=${item.limit}&offset=${item.offset}&relevant_reviews=false&request_source=1&shopid=${item.shopId}&tag_filter=&type=${item.type}&variation_filters=`;

      const response = await axios.get(url);
      ratings.push(...response.data.data.ratings);
    })
  );

  return ratings;
};

const renderColumnData = (comment) => {
  return {
    content: formatComment(comment),
  };
};

const addDataToWorkSheet = async () => {
  const ratings = await crawlData();

  ratings.forEach((rating, index) => {
    if (rating.comment.split('\n')[4]) {
      worksheet.addRow(renderColumnData(rating.comment.split('\n')[4]));
    } else if (rating.comment.split('\n')[3]) {
      worksheet.addRow(renderColumnData(rating.comment.split('\n')[3]));
    } else if (rating.comment.split('\n')[2]) {
      worksheet.addRow(renderColumnData(rating.comment.split('\n')[2]));
    } else if (rating.comment.split('\n')[1]) {
      worksheet.addRow(renderColumnData(rating.comment.split('\n')[1]));
    } else if (rating.comment.split('\n')[0]) {
      worksheet.addRow(renderColumnData(rating.comment.split('\n')[0]));
    }
  });
};

const writeToExcel = async () => {
  await addDataToWorkSheet();

  const exportPath = path.resolve(__dirname, 'data-crawl.xlsx');

  await workbook.xlsx.writeFile(exportPath);
};

const port = 5001;

writeToExcel();

app.listen(port, () => console.log(`Server is running on PORT ${port}`));
